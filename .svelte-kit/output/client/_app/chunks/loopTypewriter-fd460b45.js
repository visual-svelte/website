import{t as s,r as c,w as m}from"./writeEffect-0bd51c35.js";import{bf as f}from"./vendor-21d61cc0.js";import"./sleep-b92576d7.js";const h=async(e,t)=>{t.dispatch("done"),await s(typeof t.loop=="number"?t.loop:1500);const n=e.innerHTML.replaceAll("&amp;","&");for(let a=n.length-1;a>=0;a--)n[a]===">"&&(a=n.lastIndexOf("<",a)),e.innerHTML=n.slice(0,a),await s(t.unwriteInterval?t.unwriteInterval:t.interval)};let r=[];const d=e=>{for(;;){const t=c(0,e.length),n=typeof r=="number"&&t!==r,a=Array.isArray(r)&&!r.includes(t);if(e.length===1||a||n)return n&&(r=[]),r.push(t),e[t];r.length===e.length&&(r=r.pop())}},o=async({currentNode:e,text:t},n)=>{await m({currentNode:e,text:t},n);const a=t.replaceAll("&","&amp;");e.innerHTML===a&&await h(e,n),f(e,n.parentElement,l=>{e===l?l.classList.remove("typing"):l.classList.remove("finished-typing")})},x=async(e,t)=>{for(;;)if(t.loop)for(const n of e)await o(n,t);else if(t.loopRandom){const n=d(e);await o(n,t)}};export{x as mode};
